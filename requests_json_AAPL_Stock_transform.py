from http.client import responses
import pandas as pd
from pandas import json_normalize
import requests
import json
'''API request andjson data of weather'''
# response=requests.get ("https://open-meteo.com/v1/forecast",params= {"latitude":51.5,
#     "longitude" :-0.11,
#     "current" :"temperature_2m"},)
#
# #weather = response.json()
# print(response.json)

'''Json data to dataFrame'''
#Json data to PD and vice versa
# data_json = '''
# [
#   {
#     "athlete": "Jim Walmsley",
#     "year": 2019,
#     "time": "14:09:28"
#   },
#   {
#     "athlete": "Courtney Dauwalter",
#     "year": 2023,
#     "time": "15:29:34"
#   },
#   {
#     "athlete": "Killian Jornet",
#     "year": 2022,
#     "time": null
#   }
# ]
# '''
# data = json.loads(data_json)
# df=pd.DataFrame(data)
# print(df)
#
# df.to_json("test.json",orient='records',indent=2)
#
#
# df.to_json("test.json",orient='records',indent=2)
# df2=pd.read_json("test.json")
#
# print(df2)

#Jason Explode
# data = [
#   {
#     "athlete": "Jim Walmsley",
#     "years": [2016, 2018, 2019]
#   }
# ]
# df3 = pd.DataFrame(data)
# print(df3)
# df3_exploded =df3.explode('years')
# print(df3_exploded)

#API URL json data consumption
# API_KEY = 'f735caec48b70d9cc8a047db23a8a0f8'
# base_url = 'http://api.marketstack.com/v1/eod'
# params = {
#     'access_key': API_KEY,
#     'symbols': 'AAPL',
#     'limits': 5
# }
#
# response  = requests.get(base_url, params=params)
# data = response.json()
# print(response.json())
# eod_data = data.get('data',[])
# df = pd.DataFrame(eod_data)
# print(df)
#{'pagination': {'limit': 100, 'offset': 0, 'count': 100, 'total': 100}, 'data': [{'open': 262.65, 'high': 262.85, 'low': 255.43, 'close': 258.45, 'volume': 44954300.0, 'adj_high': 262.85, 'adj_low': 255.43, 'adj_close': 258.45, 'adj_open': 262.65, 'adj_volume': 45015254.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-10-22T00:00:00+0000'}, {'open': 261.88, 'high': 265.29, 'low': 261.83, 'close': 262.77, 'volume': 46659000.0, 'adj_high': 265.29, 'adj_low': 261.83, 'adj_close': 262.77, 'adj_open': 261.88, 'adj_volume': 46695948.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-10-21T00:00:00+0000'}, {'open': 255.89, 'high': 264.38, 'low': 255.63, 'close': 262.24, 'volume': 90370300.0, 'adj_high': 264.375, 'adj_low': 255.63, 'adj_close': 262.24, 'adj_open': 255.885, 'adj_volume': 90483029.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-10-20T00:00:00+0000'}, {'open': 248.02, 'high': 253.38, 'low': 247.27, 'close': 252.29, 'volume': 48876500.0, 'adj_high': 253.38, 'adj_low': 247.27, 'adj_close': 252.29, 'adj_open': 248.02, 'adj_volume': 49146961.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-10-17T00:00:00+0000'}, {'open': 248.25, 'high': 249.04, 'low': 245.13, 'close': 247.45, 'volume': 39698000.0, 'adj_high': 249.04, 'adj_low': 245.13, 'adj_close': 247.45, 'adj_open': 248.25, 'adj_volume': 39776974.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-10-16T00:00:00+0000'}, {'open': 249.49, 'high': 251.82, 'low': 247.47, 'close': 249.34, 'volume': 33839800.0, 'adj_high': 251.82, 'adj_low': 247.47, 'adj_close': 249.34, 'adj_open': 249.485, 'adj_volume': 33893611.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-10-15T00:00:00+0000'}, {'open': 246.6, 'high': 248.85, 'low': 244.7, 'close': 247.77, 'volume': 35447900.0, 'adj_high': 248.845, 'adj_low': 244.7, 'adj_close': 247.77, 'adj_open': 246.6, 'adj_volume': 35477986.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-10-14T00:00:00+0000'}, {'open': 249.38, 'high': 249.69, 'low': 245.56, 'close': 247.66, 'volume': 38104400.0, 'adj_high': 249.69, 'adj_low': 245.56, 'adj_close': 247.66, 'adj_open': 249.38, 'adj_volume': 38142942.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-10-13T00:00:00+0000'}, {'open': 254.94, 'high': 256.38, 'low': 244.0, 'close': 245.27, 'volume': 61782400.0, 'adj_high': 256.38, 'adj_low': 244.0, 'adj_close': 245.27, 'adj_open': 254.94, 'adj_volume': 61999098.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-10-10T00:00:00+0000'}, {'open': 257.81, 'high': 258.0, 'low': 253.14, 'close': 254.04, 'volume': 38270200.0, 'adj_high': 258.0, 'adj_low': 253.14, 'adj_close': 254.04, 'adj_open': 257.805, 'adj_volume': 38322012.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-10-09T00:00:00+0000'}, {'open': 256.52, 'high': 258.52, 'low': 256.11, 'close': 258.06, 'volume': 36465000.0, 'adj_high': 258.52, 'adj_low': 256.11, 'adj_close': 258.06, 'adj_open': 256.52, 'adj_volume': 36496895.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-10-08T00:00:00+0000'}, {'open': 256.81, 'high': 257.4, 'low': 255.43, 'close': 256.48, 'volume': 31923700.0, 'adj_high': 257.4, 'adj_low': 255.43, 'adj_close': 256.48, 'adj_open': 256.805, 'adj_volume': 31955776.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-10-07T00:00:00+0000'}, {'open': 257.99, 'high': 259.07, 'low': 255.05, 'close': 256.69, 'volume': 44292200.0, 'adj_high': 259.07, 'adj_low': 255.05, 'adj_close': 256.69, 'adj_open': 257.99, 'adj_volume': 44664118.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-10-06T00:00:00+0000'}, {'open': 254.67, 'high': 259.24, 'low': 253.95, 'close': 258.02, 'volume': 49107000.0, 'adj_high': 259.24, 'adj_low': 253.95, 'adj_close': 258.02, 'adj_open': 254.665, 'adj_volume': 49155614.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-10-03T00:00:00+0000'}, {'open': 256.58, 'high': 258.18, 'low': 254.15, 'close': 257.13, 'volume': 42597200.0, 'adj_high': 258.18, 'adj_low': 254.15, 'adj_close': 257.13, 'adj_open': 256.575, 'adj_volume': 42630239.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-10-02T00:00:00+0000'}, {'open': 255.04, 'high': 258.79, 'low': 254.95, 'close': 255.45, 'volume': 45889562.0, 'adj_high': 258.79, 'adj_low': 254.93, 'adj_close': 255.45, 'adj_open': 255.04, 'adj_volume': 48713940.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-10-01T00:00:00+0000'}, {'open': 254.86, 'high': 255.92, 'low': 253.11, 'close': 254.63, 'volume': 37666900.0, 'adj_high': 255.919, 'adj_low': 253.11, 'adj_close': 254.63, 'adj_open': 254.855, 'adj_volume': 37704259.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-09-30T00:00:00+0000'}, {'open': 254.56, 'high': 255.0, 'low': 253.01, 'close': 254.43, 'volume': 40091100.0, 'adj_high': 255.0, 'adj_low': 253.01, 'adj_close': 254.43, 'adj_open': 254.56, 'adj_volume': 40127687.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-09-29T00:00:00+0000'}, {'open': 254.1, 'high': 257.6, 'low': 253.78, 'close': 255.46, 'volume': 46045700.0, 'adj_high': 257.6, 'adj_low': 253.78, 'adj_close': 255.46, 'adj_open': 254.095, 'adj_volume': 46076258.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-09-26T00:00:00+0000'}, {'open': 253.21, 'high': 257.17, 'low': 251.71, 'close': 256.87, 'volume': 55061300.0, 'adj_high': 257.17, 'adj_low': 251.712, 'adj_close': 256.87, 'adj_open': 253.205, 'adj_volume': 55202075.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-09-25T00:00:00+0000'}, {'open': 255.22, 'high': 255.74, 'low': 251.04, 'close': 252.31, 'volume': 42265200.0, 'adj_high': 255.74, 'adj_low': 251.04, 'adj_close': 252.31, 'adj_open': 255.22, 'adj_volume': 42303710.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-09-24T00:00:00+0000'}, {'open': 255.88, 'high': 257.34, 'low': 253.58, 'close': 254.43, 'volume': 60232300.0, 'adj_high': 257.34, 'adj_low': 253.58, 'adj_close': 254.43, 'adj_open': 255.875, 'adj_volume': 60275187.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-09-23T00:00:00+0000'}, {'open': 248.3, 'high': 256.64, 'low': 248.12, 'close': 256.08, 'volume': 105413200.0, 'adj_high': 256.64, 'adj_low': 248.12, 'adj_close': 256.08, 'adj_open': 248.3, 'adj_volume': 105517416.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-09-22T00:00:00+0000'}, {'open': 241.23, 'high': 246.3, 'low': 240.21, 'close': 245.5, 'volume': 163470300.0, 'adj_high': 246.3, 'adj_low': 240.2106, 'adj_close': 245.5, 'adj_open': 241.225, 'adj_volume': 163741314.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-09-19T00:00:00+0000'}, {'open': 239.97, 'high': 241.2, 'low': 236.65, 'close': 237.88, 'volume': 44219200.0, 'adj_high': 241.2, 'adj_low': 236.65, 'adj_close': 237.88, 'adj_open': 239.97, 'adj_volume': 44249576.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-09-18T00:00:00+0000'}, {'open': 238.97, 'high': 240.1, 'low': 237.73, 'close': 238.99, 'volume': 46435200.0, 'adj_high': 240.1, 'adj_low': 237.7301, 'adj_close': 238.99, 'adj_open': 238.97, 'adj_volume': 46508017.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-09-17T00:00:00+0000'}, {'open': 237.18, 'high': 241.22, 'low': 236.3235, 'close': 238.15, 'volume': 61246555.0, 'adj_high': 241.22, 'adj_low': 236.3235, 'adj_close': 238.15, 'adj_open': 237.175, 'adj_volume': 63421099.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-09-16T00:00:00+0000'}, {'open': 237.0, 'high': 238.19, 'low': 235.03, 'close': 236.7, 'volume': 42583729.0, 'adj_high': 238.19, 'adj_low': 235.03, 'adj_close': 236.7, 'adj_open': 237.0, 'adj_volume': 42699524.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-09-15T00:00:00+0000'}, {'open': 229.22, 'high': 234.51, 'low': 229.02, 'close': 234.07, 'volume': 55776500.0, 'adj_high': 234.51, 'adj_low': 229.02, 'adj_close': 234.07, 'adj_open': 229.22, 'adj_volume': 55824216.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-09-12T00:00:00+0000'}, {'open': 226.88, 'high': 230.45, 'low': 226.65, 'close': 230.03, 'volume': 50150900.0, 'adj_high': 230.45, 'adj_low': 226.65, 'adj_close': 230.03, 'adj_open': 226.875, 'adj_volume': 50208578.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-09-11T00:00:00+0000'}, {'open': 232.19, 'high': 232.42, 'low': 225.95, 'close': 226.79, 'volume': 83321600.0, 'adj_high': 232.42, 'adj_low': 225.95, 'adj_close': 226.79, 'adj_open': 232.185, 'adj_volume': 83440810.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-09-10T00:00:00+0000'}, {'open': 237.0, 'high': 238.78, 'low': 233.36, 'close': 234.35, 'volume': 66153200.0, 'adj_high': 238.7805, 'adj_low': 233.36, 'adj_close': 234.35, 'adj_open': 237.0, 'adj_volume': 66313918.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-09-09T00:00:00+0000'}, {'open': 239.3, 'high': 240.15, 'low': 236.34, 'close': 237.88, 'volume': 48959400.0, 'adj_high': 240.15, 'adj_low': 236.34, 'adj_close': 237.88, 'adj_open': 239.3, 'adj_volume': 48999495.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-09-08T00:00:00+0000'}, {'open': 240.0, 'high': 241.32, 'low': 238.49, 'close': 239.69, 'volume': 54837300.0, 'adj_high': 241.32, 'adj_low': 238.4901, 'adj_close': 239.69, 'adj_open': 239.995, 'adj_volume': 54870397.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-09-05T00:00:00+0000'}, {'open': 238.45, 'high': 239.9, 'low': 236.74, 'close': 239.78, 'volume': 47504000.0, 'adj_high': 239.8999, 'adj_low': 236.74, 'adj_close': 239.78, 'adj_open': 238.45, 'adj_volume': 47549429.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-09-04T00:00:00+0000'}, {'open': 237.21, 'high': 238.85, 'low': 234.36, 'close': 238.47, 'volume': 66302400.0, 'adj_high': 238.85, 'adj_low': 234.36, 'adj_close': 238.47, 'adj_open': 237.21, 'adj_volume': 66061716.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-09-03T00:00:00+0000'}, {'open': 229.25, 'high': 230.85, 'low': 226.97, 'close': 229.72, 'volume': 43804400.0, 'adj_high': 230.85, 'adj_low': 226.97, 'adj_close': 229.72, 'adj_open': 229.25, 'adj_volume': 44075638.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-09-02T00:00:00+0000'}, {'open': 232.51, 'high': 233.38, 'low': 231.37, 'close': 232.14, 'volume': 39418437.0, 'adj_high': 233.38, 'adj_low': 231.37, 'adj_close': 232.14, 'adj_open': 232.51, 'adj_volume': 39418437.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-08-29T00:00:00+0000'}, {'open': 230.81, 'high': 233.41, 'low': 229.335, 'close': 232.56, 'volume': 37892960.0, 'adj_high': 233.41, 'adj_low': 229.335, 'adj_close': 232.56, 'adj_open': 230.82, 'adj_volume': 38074700.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-08-28T00:00:00+0000'}, {'open': 228.61, 'high': 230.9, 'low': 228.26, 'close': 230.49, 'volume': 31200700.0, 'adj_high': 230.9, 'adj_low': 228.26, 'adj_close': 230.49, 'adj_open': 228.61, 'adj_volume': 31259513.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-08-27T00:00:00+0000'}, {'open': 226.87, 'high': 229.49, 'low': 224.69, 'close': 229.31, 'volume': 54524400.0, 'adj_high': 229.49, 'adj_low': 224.69, 'adj_close': 229.31, 'adj_open': 226.87, 'adj_volume': 54575107.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-08-26T00:00:00+0000'}, {'open': 226.48, 'high': 229.3, 'low': 226.23, 'close': 227.16, 'volume': 30965700.0, 'adj_high': 229.3, 'adj_low': 226.23, 'adj_close': 227.16, 'adj_open': 226.48, 'adj_volume': 30983133.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-08-25T00:00:00+0000'}, {'open': 226.17, 'high': 229.09, 'low': 225.41, 'close': 227.76, 'volume': 42445300.0, 'adj_high': 229.09, 'adj_low': 225.41, 'adj_close': 227.76, 'adj_open': 226.17, 'adj_volume': 42477811.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-08-22T00:00:00+0000'}, {'open': 226.27, 'high': 226.52, 'low': 223.78, 'close': 224.9, 'volume': 30593700.0, 'adj_high': 226.52, 'adj_low': 223.7804, 'adj_close': 224.9, 'adj_open': 226.27, 'adj_volume': 30621249.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-08-21T00:00:00+0000'}, {'open': 229.98, 'high': 230.47, 'low': 225.77, 'close': 226.01, 'volume': 42190600.0, 'adj_high': 230.47, 'adj_low': 225.77, 'adj_close': 226.01, 'adj_open': 229.98, 'adj_volume': 42263865.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-08-20T00:00:00+0000'}, {'open': 231.28, 'high': 232.87, 'low': 229.35, 'close': 230.56, 'volume': 39320800.0, 'adj_high': 232.87, 'adj_low': 229.35, 'adj_close': 230.56, 'adj_open': 231.275, 'adj_volume': 39402564.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-08-19T00:00:00+0000'}, {'open': 231.78, 'high': 233.12, 'low': 230.11, 'close': 230.89, 'volume': 36051605.0, 'adj_high': 233.12, 'adj_low': 230.11, 'adj_close': 230.89, 'adj_open': 231.7, 'adj_volume': 37476188.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-08-18T00:00:00+0000'}, {'open': 234.0, 'high': 234.28, 'low': 229.34, 'close': 231.59, 'volume': 56010500.0, 'adj_high': 234.28, 'adj_low': 229.335, 'adj_close': 231.59, 'adj_open': 234.0, 'adj_volume': 56038657.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-08-15T00:00:00+0000'}, {'open': 234.06, 'high': 235.12, 'low': 230.85, 'close': 232.78, 'volume': 51857600.0, 'adj_high': 235.12, 'adj_low': 230.85, 'adj_close': 232.78, 'adj_open': 234.055, 'adj_volume': 51916275.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-08-14T00:00:00+0000'}, {'open': 231.07, 'high': 235.0, 'low': 230.43, 'close': 233.33, 'volume': 69833200.0, 'adj_high': 235.0, 'adj_low': 230.43, 'adj_close': 233.33, 'adj_open': 231.07, 'adj_volume': 69878546.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-08-13T00:00:00+0000'}, {'open': 228.01, 'high': 230.8, 'low': 227.07, 'close': 229.65, 'volume': 55626200.0, 'adj_high': 230.8, 'adj_low': 227.07, 'adj_close': 229.65, 'adj_open': 228.005, 'adj_volume': 55672301.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-08-12T00:00:00+0000'}, {'open': 227.92, 'high': 229.56, 'low': 224.76, 'close': 227.18, 'volume': 61725300.0, 'adj_high': 229.56, 'adj_low': 224.76, 'adj_close': 227.18, 'adj_open': 227.92, 'adj_volume': 61806132.0, 'split_factor': 1.0, 'dividend': 0.26, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-08-11T00:00:00+0000'}, {'open': 220.83, 'high': 231.0, 'low': 219.25, 'close': 229.35, 'volume': 113696100.0, 'adj_high': 231.0, 'adj_low': 219.25, 'adj_close': 229.35, 'adj_open': 220.83, 'adj_volume': 113853967.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-08-08T00:00:00+0000'}, {'open': 218.88, 'high': 220.85, 'low': 216.58, 'close': 220.03, 'volume': 89932900.0, 'adj_high': 220.85, 'adj_low': 216.58, 'adj_close': 220.03, 'adj_open': 218.875, 'adj_volume': 90224834.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-08-07T00:00:00+0000'}, {'open': 205.63, 'high': 215.38, 'low': 205.59, 'close': 213.25, 'volume': 106498000.0, 'adj_high': 215.38, 'adj_low': 205.59, 'adj_close': 213.25, 'adj_open': 205.63, 'adj_volume': 108483103.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-08-06T00:00:00+0000'}, {'open': 203.4, 'high': 205.34, 'low': 202.16, 'close': 202.92, 'volume': 44106200.0, 'adj_high': 205.34, 'adj_low': 202.16, 'adj_close': 202.92, 'adj_open': 203.4, 'adj_volume': 44155079.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-08-05T00:00:00+0000'}, {'open': 204.51, 'high': 207.88, 'low': 201.68, 'close': 203.35, 'volume': 75020600.0, 'adj_high': 207.88, 'adj_low': 201.675, 'adj_close': 203.35, 'adj_open': 204.505, 'adj_volume': 75109298.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-08-04T00:00:00+0000'}, {'open': 210.87, 'high': 213.58, 'low': 201.5, 'close': 202.38, 'volume': 104301700.0, 'adj_high': 213.58, 'adj_low': 201.5, 'adj_close': 202.38, 'adj_open': 210.865, 'adj_volume': 104434473.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-08-01T00:00:00+0000'}, {'open': 208.49, 'high': 209.84, 'low': 207.16, 'close': 207.57, 'volume': 78744400.0, 'adj_high': 209.84, 'adj_low': 207.16, 'adj_close': 207.57, 'adj_open': 208.49, 'adj_volume': 80698431.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-07-31T00:00:00+0000'}, {'open': 211.9, 'high': 212.39, 'low': 207.72, 'close': 209.05, 'volume': 43797200.0, 'adj_high': 212.39, 'adj_low': 207.72, 'adj_close': 209.05, 'adj_open': 211.895, 'adj_volume': 45512514.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-07-30T00:00:00+0000'}, {'open': 214.18, 'high': 214.81, 'low': 210.82, 'close': 211.27, 'volume': 49943600.0, 'adj_high': 214.81, 'adj_low': 210.82, 'adj_close': 211.27, 'adj_open': 214.175, 'adj_volume': 51411723.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-07-29T00:00:00+0000'}, {'open': 214.03, 'high': 214.85, 'low': 213.06, 'close': 214.05, 'volume': 37796900.0, 'adj_high': 214.845, 'adj_low': 213.06, 'adj_close': 214.05, 'adj_open': 214.03, 'adj_volume': 37858017.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-07-28T00:00:00+0000'}, {'open': 214.7, 'high': 215.24, 'low': 213.4, 'close': 213.88, 'volume': 40219700.0, 'adj_high': 215.24, 'adj_low': 213.4, 'adj_close': 213.88, 'adj_open': 214.7, 'adj_volume': 40268781.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-07-25T00:00:00+0000'}, {'open': 213.9, 'high': 215.69, 'low': 213.53, 'close': 213.76, 'volume': 45773373.0, 'adj_high': 215.69, 'adj_low': 213.53, 'adj_close': 213.76, 'adj_open': 213.9, 'adj_volume': 46022620.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-07-24T00:00:00+0000'}, {'open': 215.045, 'high': 215.1, 'low': 212.41, 'close': 214.15, 'volume': 46415026.0, 'adj_high': 215.15, 'adj_low': 212.41, 'adj_close': 214.15, 'adj_open': 215.0, 'adj_volume': 46989301.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-07-23T00:00:00+0000'}, {'open': 213.14, 'high': 214.95, 'low': 212.23, 'close': 214.4, 'volume': 46300400.0, 'adj_high': 214.95, 'adj_low': 212.2301, 'adj_close': 214.4, 'adj_open': 213.14, 'adj_volume': 46404072.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-07-22T00:00:00+0000'}, {'open': 212.05, 'high': 215.78, 'low': 211.6409, 'close': 212.48, 'volume': 51064253.0, 'adj_high': 215.78, 'adj_low': 211.63, 'adj_close': 212.48, 'adj_open': 212.1, 'adj_volume': 51377434.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-07-21T00:00:00+0000'}, {'open': 210.87, 'high': 211.79, 'low': 209.7, 'close': 211.18, 'volume': 48939500.0, 'adj_high': 211.79, 'adj_low': 209.7045, 'adj_close': 211.18, 'adj_open': 210.87, 'adj_volume': 48974591.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-07-18T00:00:00+0000'}, {'open': 210.625, 'high': 211.8, 'low': 209.59, 'close': 210.02, 'volume': 47738194.0, 'adj_high': 211.8, 'adj_low': 209.59, 'adj_close': 210.02, 'adj_open': 210.57, 'adj_volume': 48068141.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-07-17T00:00:00+0000'}, {'open': 210.29, 'high': 212.4, 'low': 208.64, 'close': 210.16, 'volume': 47148580.0, 'adj_high': 212.4, 'adj_low': 208.64, 'adj_close': 210.16, 'adj_open': 210.295, 'adj_volume': 47490532.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-07-16T00:00:00+0000'}, {'open': 209.15, 'high': 211.89, 'low': 208.92, 'close': 209.11, 'volume': 42071894.0, 'adj_high': 211.89, 'adj_low': 208.92, 'adj_close': 209.11, 'adj_open': 209.22, 'adj_volume': 42296339.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-07-15T00:00:00+0000'}, {'open': 209.909, 'high': 210.91, 'low': 207.54, 'close': 208.62, 'volume': 37683849.0, 'adj_high': 210.91, 'adj_low': 207.54, 'adj_close': 208.62, 'adj_open': 209.925, 'adj_volume': 38840111.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-07-14T00:00:00+0000'}, {'open': 210.57, 'high': 212.13, 'low': 209.86, 'close': 211.16, 'volume': 39719300.0, 'adj_high': 212.13, 'adj_low': 209.86, 'adj_close': 211.16, 'adj_open': 210.565, 'adj_volume': 39765812.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-07-11T00:00:00+0000'}, {'open': 210.505, 'high': 213.48, 'low': 210.12, 'close': 212.41, 'volume': 43770740.0, 'adj_high': 213.48, 'adj_low': 210.03, 'adj_close': 212.41, 'adj_open': 210.505, 'adj_volume': 44443635.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-07-10T00:00:00+0000'}, {'open': 209.53, 'high': 211.33, 'low': 207.22, 'close': 211.14, 'volume': 48408519.0, 'adj_high': 211.33, 'adj_low': 207.22, 'adj_close': 211.14, 'adj_open': 209.53, 'adj_volume': 48749367.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-07-09T00:00:00+0000'}, {'open': 210.13, 'high': 211.43, 'low': 208.45, 'close': 210.01, 'volume': 42036884.0, 'adj_high': 211.43, 'adj_low': 208.45, 'adj_close': 210.01, 'adj_open': 210.1, 'adj_volume': 42848928.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-07-08T00:00:00+0000'}, {'open': 212.68, 'high': 216.23, 'low': 208.8, 'close': 209.95, 'volume': 49905104.0, 'adj_high': 216.23, 'adj_low': 208.8, 'adj_close': 209.95, 'adj_open': 212.68, 'adj_volume': 50228984.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-07-07T00:00:00+0000'}, {'open': 212.145, 'high': 214.65, 'low': 211.8101, 'close': 213.55, 'volume': 34955836.0, 'adj_high': 214.65, 'adj_low': 211.8101, 'adj_close': 213.55, 'adj_open': 212.145, 'adj_volume': 34955836.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-07-03T00:00:00+0000'}, {'open': 209.08, 'high': 213.34, 'low': 208.14, 'close': 212.44, 'volume': 67834447.0, 'adj_high': 213.34, 'adj_low': 208.14, 'adj_close': 212.44, 'adj_open': 208.91, 'adj_volume': 67941811.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-07-02T00:00:00+0000'}, {'open': 206.665, 'high': 210.1865, 'low': 206.1401, 'close': 207.82, 'volume': 77921627.0, 'adj_high': 210.1865, 'adj_low': 206.1401, 'adj_close': 207.82, 'adj_open': 206.665, 'adj_volume': 78788867.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-07-01T00:00:00+0000'}, {'open': 202.01, 'high': 207.39, 'low': 199.2607, 'close': 205.17, 'volume': 90651078.0, 'adj_high': 207.39, 'adj_low': 199.2607, 'adj_close': 205.17, 'adj_open': 202.01, 'adj_volume': 91912816.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-06-30T00:00:00+0000'}, {'open': 201.89, 'high': 203.22, 'low': 200.0, 'close': 201.08, 'volume': 73114100.0, 'adj_high': 203.22, 'adj_low': 200.0, 'adj_close': 201.08, 'adj_open': 201.89, 'adj_volume': 73188571.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-06-27T00:00:00+0000'}, {'open': 201.43, 'high': 202.615, 'low': 199.46, 'close': 201.0, 'volume': 50117398.0, 'adj_high': 202.64, 'adj_low': 199.46, 'adj_close': 201.0, 'adj_open': 201.43, 'adj_volume': 50799121.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-06-26T00:00:00+0000'}, {'open': 201.45, 'high': 203.67, 'low': 200.62, 'close': 201.56, 'volume': 39454000.0, 'adj_high': 203.67, 'adj_low': 200.6201, 'adj_close': 201.56, 'adj_open': 201.45, 'adj_volume': 39525730.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-06-25T00:00:00+0000'}, {'open': 202.59, 'high': 203.44, 'low': 200.2, 'close': 200.3, 'volume': 53899923.0, 'adj_high': 203.44, 'adj_low': 200.2, 'adj_close': 200.3, 'adj_open': 202.59, 'adj_volume': 54064033.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-06-24T00:00:00+0000'}, {'open': 201.532, 'high': 202.3, 'low': 198.96, 'close': 201.5, 'volume': 55481396.0, 'adj_high': 202.3, 'adj_low': 198.96, 'adj_close': 201.5, 'adj_open': 201.625, 'adj_volume': 55814272.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-06-23T00:00:00+0000'}, {'open': 198.235, 'high': 201.7, 'low': 196.855, 'close': 201.0, 'volume': 96813542.0, 'adj_high': 201.7, 'adj_low': 196.855, 'adj_close': 201.0, 'adj_open': 198.235, 'adj_volume': 96813542.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-06-20T00:00:00+0000'}, {'open': 195.945, 'high': 197.57, 'low': 195.07, 'close': 196.58, 'volume': 44864157.0, 'adj_high': 197.57, 'adj_low': 195.07, 'adj_close': 196.58, 'adj_open': 195.94, 'adj_volume': 45394689.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-06-18T00:00:00+0000'}, {'open': 197.2, 'high': 198.3889, 'low': 195.21, 'close': 195.64, 'volume': 38772936.0, 'adj_high': 198.39, 'adj_low': 195.21, 'adj_close': 195.64, 'adj_open': 197.2, 'adj_volume': 38856152.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-06-17T00:00:00+0000'}, {'open': 197.29, 'high': 198.685, 'low': 196.5636, 'close': 198.42, 'volume': 42837838.0, 'adj_high': 198.685, 'adj_low': 196.5636, 'adj_close': 198.42, 'adj_open': 197.3, 'adj_volume': 43020691.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-06-16T00:00:00+0000'}, {'open': 199.73, 'high': 200.37, 'low': 195.7, 'close': 196.45, 'volume': 51362400.0, 'adj_high': 200.37, 'adj_low': 195.7, 'adj_close': 196.45, 'adj_open': 199.73, 'adj_volume': 51447349.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-06-13T00:00:00+0000'}, {'open': 199.08, 'high': 199.68, 'low': 197.36, 'close': 199.2, 'volume': 43758300.0, 'adj_high': 199.68, 'adj_low': 197.3601, 'adj_close': 199.2, 'adj_open': 199.08, 'adj_volume': 43904635.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-06-12T00:00:00+0000'}, {'open': 203.5, 'high': 204.5, 'low': 198.41, 'close': 198.78, 'volume': 60820200.0, 'adj_high': 204.5, 'adj_low': 198.41, 'adj_close': 198.78, 'adj_open': 203.5, 'adj_volume': 60989857.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-06-11T00:00:00+0000'}, {'open': 200.6, 'high': 204.35, 'low': 200.57, 'close': 202.67, 'volume': 54553200.0, 'adj_high': 204.35, 'adj_low': 200.57, 'adj_close': 202.67, 'adj_open': 200.6, 'adj_volume': 54672608.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-06-10T00:00:00+0000'}, {'open': 204.39, 'high': 206.0, 'low': 200.02, 'close': 201.45, 'volume': 72726700.0, 'adj_high': 206.0, 'adj_low': 200.02, 'adj_close': 201.45, 'adj_open': 204.39, 'adj_volume': 72862557.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-06-09T00:00:00+0000'}, {'open': 203.0, 'high': 205.7, 'low': 202.05, 'close': 203.92, 'volume': 46539200.0, 'adj_high': 205.7, 'adj_low': 202.05, 'adj_close': 203.92, 'adj_open': 203.0, 'adj_volume': 46607693.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-06-06T00:00:00+0000'}, {'open': 203.5, 'high': 204.75, 'low': 200.15, 'close': 200.63, 'volume': 55126100.0, 'adj_high': 204.75, 'adj_low': 200.15, 'adj_close': 200.63, 'adj_open': 203.5, 'adj_volume': 55221235.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-06-05T00:00:00+0000'}, {'open': 202.91, 'high': 206.24, 'low': 202.15, 'close': 202.82, 'volume': 42889828.0, 'adj_high': 206.24, 'adj_low': 202.1, 'adj_close': 202.82, 'adj_open': 202.91, 'adj_volume': 43603985.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-06-04T00:00:00+0000'}, {'open': 201.35, 'high': 203.77, 'low': 200.96, 'close': 203.27, 'volume': 46342500.0, 'adj_high': 203.77, 'adj_low': 200.955, 'adj_close': 203.27, 'adj_open': 201.35, 'adj_volume': 46381567.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-06-03T00:00:00+0000'}, {'open': 200.15, 'high': 202.13, 'low': 200.12, 'close': 201.7, 'volume': 35314257.0, 'adj_high': 202.13, 'adj_low': 200.12, 'adj_close': 201.7, 'adj_open': 200.28, 'adj_volume': 35423294.0, 'split_factor': 1.0, 'dividend': 0.0, 'symbol': 'AAPL', 'exchange': 'XNAS', 'date': '2025-06-02T00:00:00+0000'}]}

# Normalize & flatten cascaded json file into datafile
'''put one record in one row and extend cascaded records into another row/column'''
data = {
  "player": "Babe Ruth",
  "cards": [
    {
      "year": 1914,
      "card_set": "Baltimore News",
      "details": {
        "grade": "VG 3",
        "estimated_value_usd": 6000000,
        "rarity": "extremely rare"
      }
    },
    {
      "year": 1933,
      "card_set": "Goudey",
      "variations": [
        {
          "number": 53,
          "color": "yellow background",
          "grade": "NM-MT 8",
          "estimated_value_usd": 500000
        },
        {
          "number": 144,
          "color": "full body pose",
          "grade": "EX 5",
          "estimated_value_usd": 150000
        }
      ]
    }
  ]
}

#Normalise  top level cards and load to the DataFrame
df_cards = pd.json_normalize(data['cards'],
    sep='_',
    record_prefix='',
    meta=['year', 'card_set'],
    record_path=None
)

# once Json file loaded, check if  details and variations columns exist then load those into another table(row)

## Flatten 'details' if it exists
df_details = pd.json_normalize(data['cards'], record_path=None, meta=['year', 'card_set'])
if 'details' in df_details.columns:
    df_details = pd.concat([df_details.drop(columns='details'), df_details['details'].apply(pd.Series)], axis=1)

## Flatten 'variations' only where they exist
cards_with_variations = [c for c in data['cards'] if 'variations' in c]
df_variations = pd.json_normalize(
    cards_with_variations,
    record_path='variations',
    meta=['year', 'card_set'],
    errors='ignore'
)
print(df_cards)
print(df_cards.columns)
print(df_details.columns)
print(df_variations)